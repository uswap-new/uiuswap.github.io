<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swap Hive - Modern UI</title>
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.json" />
    <link rel="icon" href="assets/hiveupme.png">
    
    <!-- Libraries -->
    <script src="./libs/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="./libs/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="./libs/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="./libs/@hiveio/hive-js/dist/hive.min.js"></script>
    <script src="./libs/axios/dist/axios.min.js"></script>
    <script src="./libs/sscjs@latest/dist/ssc.min.js"></script>
    <script src="./libs/ajax/libs/uuid/8.1.0/uuidv4.min.js"></script>
    <script src="./libs/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Application Modules (order matters!) -->
    <script src="js/utils.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/apiManager.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/market.js"></script>
    <script src="js/swap.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
    
    <style>
        body {
            visibility: hidden;
        }
    </style>
    <link rel="stylesheet" href="css/modern-dark.css">
    
    <script>
        $(window).on("load", function() {
            $("body").css("visibility", "visible");
            $("#logo").show();

            // Auto-refresh balance every 30 seconds if username is present
            setInterval(function() {
                var username = $("#username").val().trim();
                if (username) {
                    $("#checkbalance").trigger("click");
                }
            }, 30000);
        });
    </script>
</head>

<body>
    <!-- Auth Modal -->
    <div class="modal fade" id="authqr" data-bs-backdrop="static" data-bs-keyboard="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass-card">
                <div class="modal-body p-4">
                    <div id="qr-div" class="d-none flex-column align-items-center justify-content-center">
                        <a target="_blank" id="qr-link" class="qr-container">
                            <img id="qr-code" class="qr-image">
                        </a>
                        <p class="mt-4 text-center modal-text">Scan or tap this QR code with your Hive Authentication App</p>
                    </div>
                    <div id="approve-div" class="d-none flex-column align-items-center justify-content-center">
                        <div class="success-icon mb-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                            </svg>
                        </div>
                        <p class="text-center modal-text mb-3">Successfully Connected!</p>
                        <p class="text-center modal-subtext mb-4">Click approve and confirm the transaction</p>
                        <button type="button" id="approve" class="btn btn-gradient w-100">Approve Transaction</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Header -->
    <nav class="navbar navbar-expand-lg navbar-glass sticky-top">
        <div class="container-fluid px-4">
            <div class="navbar-brand d-flex align-items-center justify-content-center w-100" style="text-align:center;">
                <img id="logo" src="assets/icons/icon-144x144.png" alt="Logo" class="nav-logo me-3">
                <div>
                    <h1 class="brand-title mb-0">SWAP HIVE</h1>
                    <p class="brand-subtitle mb-0">Liquidity Bridge</p>
                </div>
            </div>
            <div class="d-flex align-items-center ms-auto">
                <a href="https://hbd.uswap.app" target="_blank" class="btn btn-outline-primary btn-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16" class="me-1">
                        <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                        <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                    </svg>
                    HBD Swap
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid main-container">
        <div class="row g-2">
            <!-- Left Column - Wallet Info -->
            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="glass-card h-100">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
                                <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z"/>
                            </svg>
                            Wallet
                        </h3>
                    </div>
                    <div class="card-body-custom">
                        <div class="input-group mb-3">
                            <span class="input-group-text">@</span>
                            <input type="text" class="form-control" id="username" placeholder="Username">
                        </div>
                        <button type="button" id="checkbalance" class="btn btn-gradient w-100 mb-3">Load Balance</button>
                        
                        <div class="balance-display mb-3">
                            <div class="balance-item">
                                <span class="balance-label">HIVE</span>
                                <span class="balance-amount" id="hive">0.000</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-label">SWAP.HIVE</span>
                                <span class="balance-amount" id="swaphive">0.000</span>
                            </div>
                        </div>

                        <div class="divider"></div>

                        <!-- Fee Info -->
                        <div class="info-section">
                            <h4 class="section-title">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                </svg>
                                Fee Information
                            </h4>
                            
                            <div class="fee-table">
                                <div class="fee-row-header">HIVE → SWAP.HIVE</div>
                                <div class="fee-row">
                                    <span>Min Fee</span>
                                    <span class="fee-value">-0.50%</span>
                                </div>
                                <div class="fee-row">
                                    <span>Mid Fee</span>
                                    <span class="fee-value">0.20%</span>
                                </div>
                                <div class="fee-row">
                                    <span>Max Fee</span>
                                    <span class="fee-value">0.65%</span>
                                </div>
                            </div>

                            <div class="fee-table mt-3">
                                <div class="fee-row-header">SWAP.HIVE → HIVE</div>
                                <div class="fee-row">
                                    <span>Min Fee</span>
                                    <span class="fee-value">-0.50%</span>
                                </div>
                                <div class="fee-row">
                                    <span>Mid Fee</span>
                                    <span class="fee-value">0.20%</span>
                                </div>
                                <div class="fee-row">
                                    <span>Max Fee</span>
                                    <span class="fee-value">0.65%</span>
                                </div>
                            </div>
                        </div>

                        <div class="divider"></div>

                        <!-- Links -->
                        <div class="links-section">
                            <a href="https://peakd.com/swap/@hiveupme/hiveupme-swap-script-simple-ui-solution" target="_blank" class="info-link">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
                                    <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
                                </svg>
                                Learn How to Use
                            </a>
                            <div class="social-links mt-3">
                                <a href="https://discord.com/invite/XYMrvyr" target="_blank" class="social-link" title="Discord">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z"/>
                                    </svg>
                                </a>
                                <a href="https://peakd.com/@uswap/" target="_blank" class="social-link" title="Hive Blog">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 220 190">
                                        <path d="M157.27,107.26a1,1,0,0,1,.82,1.42l-46.75,80.85a1,1,0,0,1-.82.47H81.94a.94.94,0,0,1-.81-1.42l46.75-80.85a.94.94,0,0,1,.81-.47ZM129.48,84.09a1,1,0,0,1-.82-.47L81.13,1.42A.94.94,0,0,1,81.94,0h28.58a1,1,0,0,1,.82.47l47.53,82.2a.94.94,0,0,1-.81,1.42Z"/>
                                        <path d="M135.13,1.42A.94.94,0,0,1,136,0h28.62a.93.93,0,0,1,.81.47l54.49,94.06a.93.93,0,0,1,0,.94l-54.49,94.06a.93.93,0,0,1-.81.47H136a.94.94,0,0,1-.82-1.42L189.34,95Zm-23.26,93.1a1,1,0,0,1,0,1L57.13,189.53a1,1,0,0,1-1.65,0L.13,95.48a1,1,0,0,1,0-1L54.87.47a1,1,0,0,1,1.65,0Z"/>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Center Column - Swap Interface -->
            <div class="col-xl-6 col-lg-6 col-md-12">
                <div class="glass-card h-100">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                            </svg>
                            Swap Tokens
                        </h3>
                        <div class="minimum-badge">
                            Minimum: <span id="minimum">1 HIVE</span>
                        </div>
                    </div>
                    <div class="card-body-custom">
                        <!-- From Token -->
                        <div class="swap-input-container">
                            <label class="swap-label">You Send</label>
                            <div class="swap-input-wrapper">
                                <input type="number" class="swap-input" id="inputquantity" placeholder="0.00">
                                <select id="input" class="token-select">
                                    <option value="HIVE">HIVE</option>
                                    <option value="SWAP.HIVE">SWAP.HIVE</option>
                                </select>
                            </div>
                        </div>

                        <!-- Reverse Button -->
                        <div class="swap-reverse-container">
                            <button type="button" id="reverse" class="swap-reverse-btn">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"/>
                                </svg>
                            </button>
                        </div>

                        <!-- To Token -->
                        <div class="swap-input-container">
                            <label class="swap-label">You Receive</label>
                            <div class="swap-input-wrapper">
                                <input type="number" class="swap-input" id="outputquantity" placeholder="0.00" readonly>
                                <select id="output" class="token-select" disabled>
                                    <option value="HIVE">HIVE</option>
                                    <option value="SWAP.HIVE" selected>SWAP.HIVE</option>
                                </select>
                            </div>
                        </div>

                        <!-- Fee Info -->
                        <div class="fee-info-box">
                            <div class="fee-info-row">
                                <span>Expected Fee:</span>
                                <span class="fee-info-value">
                                    <span id="expectedfee">0.000</span>
                                    <span id="feeticker">HIVE</span>
                                    (<span id="expectedper">0.000</span>%)
                                </span>
                            </div>
                        </div>

                        <div class="divider"></div>

                        <!-- Slippage Settings -->
                        <div class="slippage-section">
                            <h4 class="section-subtitle">Slippage Tolerance</h4>
                            <div class="slippage-options">
                                <label class="slippage-option">
                                    <input type="radio" name="my-radio-group" value="0.00">
                                    <span>0.00%</span>
                                </label>
                                <label class="slippage-option">
                                    <input type="radio" name="my-radio-group" value="0.01" checked>
                                    <span>0.01%</span>
                                </label>
                                <label class="slippage-option">
                                    <input type="radio" name="my-radio-group" value="0.05">
                                    <span>0.05%</span>
                                </label>
                                <label class="slippage-option">
                                    <input type="radio" name="my-radio-group" value="0.10">
                                    <span>0.10%</span>
                                </label>
                                <label class="slippage-option">
                                    <input type="radio" name="my-radio-group" value="0.20">
                                    <span>0.20%</span>
                                </label>
                            </div>
                            <div class="min-receive-info">
                                Minimum to Receive: 
                                <span class="min-receive-value">
                                    <span id="slipageqty">0.000</span>
                                    <span id="minreceivesymbol">SWAP.HIVE</span>
                                </span>
                            </div>
                        </div>

                        <div class="divider"></div>

                        <!-- Authentication Method -->
                        <div class="auth-method-section">
                            <h4 class="section-subtitle">Authentication Method</h4>
                            <div class="auth-methods">
                                <label class="auth-method">
                                    <input type="radio" name="txtype" id="txtype" value="Hive Keychain" checked disabled>
                                    <div class="auth-method-card">
                                        <img src="assets/hive_keychain.png" alt="Keychain" class="auth-icon">
                                        <span>Hive Keychain</span>
                                    </div>
                                </label>
                                <label class="auth-method">
                                    <input type="radio" name="txtype" id="txtype1" value="Hive Auth" disabled>
                                    <div class="auth-method-card">
                                        <img src="assets/hive_auth.png" alt="Hive Auth" class="auth-icon">
                                        <span>Hive Auth</span>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Swap Button -->
                        <button type="button" id="swap" class="btn btn-gradient btn-lg w-100 mt-4" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                            </svg>
                            SWAP NOW
                        </button>

                        <!-- Status -->
                        <div class="status-container mt-3">
                            <div id="loading" class="d-none spinner-border spinner-border-sm text-primary"></div>
                            <span id="status" class="status-text ms-2"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Market Info & Liquidity -->
            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="d-flex flex-column h-100 gap-3">
                <!-- Liquidity Pool -->
                <div class="glass-card">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z"/>
                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                            </svg>
                            Liquidity Pool
                        </h3>
                        <button type="button" id="refresh" class="btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="liquidity-info">
                            <p class="liquidity-account">@uswap</p>
                            <div class="liquidity-amounts">
                                <div class="liquidity-item">
                                    <span class="liquidity-label">HIVE</span>
                                    <span class="liquidity-value" id="hiveliquidity">0.000</span>
                                </div>
                                <div class="liquidity-item">
                                    <span class="liquidity-label">SWAP.HIVE</span>
                                    <span class="liquidity-value" id="swaphiveliquidity">0.000</span>
                                </div>
                            </div>
                        </div>
                        <div class="info-box mt-3">
                            <p class="info-text">Provide liquidity and earn up to <strong>0.5%</strong> instant rewards!</p>
                        </div>
                    </div>
                </div>

                <!-- Market Info -->
                <div class="glass-card">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z"/>
                            </svg>
                            HIVE Markets
                        </h3>
                        <button type="button" class="refreshHiveMarket btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="market-item">
                            <a href="https://wallet.hive.blog/market" target="_blank" class="market-link">
                                <img src="assets/icons/hive-72x72.png" alt="HIVE" class="market-icon">
                                <span>HIVE</span>
                            </a>
                            <span class="market-price" id="hiveusdprice">$0.00</span>
                        </div>
                        <div class="market-item">
                            <a href="https://wallet.hive.blog/market" target="_blank" class="market-link">
                                <img src="assets/icons/hive-72x72.png" alt="HBD" class="market-icon">
                                <span>HBD</span>
                            </a>
                            <span class="market-price" id="hbdusdprice">$0.00</span>
                        </div>
                    </div>
                </div>

                <!-- Token Market Info -->
                <div class="glass-card flex-grow-1">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M5.5 9.511c.076.954.83 1.697 2.182 1.785V12h.6v-.709c1.4-.098 2.218-.846 2.218-1.932 0-.987-.626-1.496-1.745-1.76l-.473-.112V5.57c.6.068.982.396 1.074.85h1.052c-.076-.919-.864-1.638-2.126-1.716V4h-.6v.719c-1.195.117-2.01.836-2.01 1.853 0 .9.606 1.472 1.613 1.707l.397.098v2.034c-.615-.093-1.022-.43-1.114-.9H5.5zm2.177-2.166c-.59-.137-.91-.416-.91-.836 0-.47.345-.822.915-.925v1.76h-.005zm.692 1.193c.717.166 1.048.435 1.048.91 0 .542-.412.914-1.135.982V8.518l.087.02z"/>
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 13.5a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11zm0 .5A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"/>
                            </svg>
                            Token Markets
                        </h3>
                        <button type="button" class="refreshTokenMarket btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="market-item">
                            <a href="https://hive-engine.com/trade/VAULT" target="_blank" class="market-link">
                                <img src="assets/icons/vault-72x72.png" alt="VAULT" class="market-icon">
                                <span>VAULT</span>
                            </a>
                            <span class="market-price" id="vaultusdprice">$0.00</span>
                        </div>
                        <div class="market-item">
                            <a href="https://hive-engine.com/trade/UPME" target="_blank" class="market-link">
                                <img src="assets/icons/upme-72x72.png" alt="UPME" class="market-icon">
                                <span>UPME</span>
                            </a>
                            <span class="market-price" id="upmeusdprice">$0.00</span>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>

        <!-- Transaction History -->
        <div id="historycard" class="row g-4 mt-2 d-none">
            <div class="col-md-6">
                <div class="glass-card">
                    <div class="card-header-custom">
                        <h3 class="card-title">HIVE History</h3>
                        <button type="button" class="refreshHistory btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="history-table-wrapper">
                            <table class="history-table">
                                <thead>
                                    <tr>
                                        <th>ACCOUNT</th>
                                        <th>QUANTITY</th>
                                        <th>TYPE</th>
                                        <th>TIME</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="historyHive">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="glass-card">
                    <div class="card-header-custom">
                        <h3 class="card-title">SWAP.HIVE History</h3>
                        <button type="button" class="refreshHistory btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="history-table-wrapper">
                            <table class="history-table">
                                <thead>
                                    <tr>
                                        <th>ACCOUNT</th>
                                        <th>QUANTITY</th>
                                        <th>TYPE</th>
                                        <th>TIME</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="historySwapHive">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Swap History Panel -->
        <div class="row g-4 mt-2">
            <div class="col-12">
                <div class="glass-card">
                    <div class="card-header-custom">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z"/>
                            </svg>
                            My Recent Swaps
                        </h3>
                        <button type="button" id="refreshSwapHistory" class="btn-refresh">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="card-body-custom">
                        <div class="history-table-wrapper">
                            <table class="history-table">
                                <thead>
                                    <tr>
                                        <th>Date/Time</th>
                                        <th>Tx ID (Sent)</th>
                                        <th>Amount Sent</th>
                                        <th>Tx ID (Received)</th>
                                        <th>Amount Received</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="swapHistoryTable">
                                    <tr>
                                        <td colspan="6" class="text-center" style="padding: 2rem; color: var(--text-secondary);">
                                            Load your balance to view recent swaps
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="container-fluid px-4">
            <div class="footer-content">
                <div class="footer-credit">
                    Developed by 
                    <a href="https://peakd.com/@ali-h" target="_blank">@ali-h</a> 
                    & 
                    <a href="https://peakd.com/@theguruasia" target="_blank">@theguruasia</a>
                </div>
                <div class="footer-nodes">
                    <div class="node-selector">
                        <span>Hive API:</span>
                        <button id="popup-button-hive" class="node-btn">https://anyx.io</button>
                    </div>
                    <div class="node-selector">
                        <span>Engine API:</span>
                        <button id="popup-button-engine" class="node-btn">https://engine.rishipanthee.com</button>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Node Selector Popups -->
    <div id="popup-container-hive" class="node-popup" style="display: none;">
        <div class="node-popup-content">
            <h4>Select Hive API Node</h4>
            <div id="popup-error-hive" class="popup-error-message" style="display: none;"></div>
            <div class="node-table-wrapper">
                <table id="api-list-hive">
                    <thead>
                        <tr>
                            <th>Node URL</th>
                            <th style="width: 100px; text-align: center;">Status</th>
                            <th style="width: 80px; text-align: center;">Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <button id="close-button-hive" class="node-close-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>
    </div>

    <div id="popup-container-engine" class="node-popup" style="display: none;">
        <div class="node-popup-content">
            <h4>Select Engine API Node</h4>
            <div id="popup-error-engine" class="popup-error-message" style="display: none;"></div>
            <div class="node-table-wrapper">
                <table id="api-list-engine">
                    <thead>
                        <tr>
                            <th>Node URL</th>
                            <th style="width: 100px; text-align: center;">Status</th>
                            <th style="width: 80px; text-align: center;">Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <button id="close-button-engine" class="node-close-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener("load", function() {
                navigator.serviceWorker
                    .register("/sw.js")
                    .then(res => console.log("service worker registered"))
                    .catch(err => console.log("service worker not registered", err))
            });
        }
    </script>
</body>
</html>
